MODULE trcini_bling
   !!======================================================================
   !!                         ***  MODULE trcini_bling  ***
   !! TOP :   initialisation of the BLINGv0 tracers
   !!======================================================================
   !! History :   2.0  !  2007-12  (C. Ethe, G. Madec) Original code
   !!----------------------------------------------------------------------

   !!----------------------------------------------------------------------

   !!----------------------------------------------------------------------
   !! trc_ini_bling   : BLINGv0 model initialisation
   !!----------------------------------------------------------------------
   USE par_trc         ! TOP parameters
   USE oce_trc
   USE trc
   USE trcnam_bling
   USE trcsms_blingv0
   USE trcopt_blingv0
   USE trcext_blingv0

   !: PISCES indices for PO4, DOC, O2, F to initialize BLING fields
   !USE par_pisces , ONLY : jppo4, jpdoc, jpoxy, jpfer 

   ! BLINGv0 modules
   USE vars_bling

   IMPLICIT NONE
   PRIVATE

   PUBLIC   trc_ini_bling   ! called by trcini.F90 module

   !!----------------------------------------------------------------------
   !! NEMO/TOP 3.3 , NEMO Consortium (2010)
   !! $Id: trcini_bling.F90 -1   $ 
   !! Software governed by the CeCILL licence     (NEMOGCM/NEMO_CeCILL.txt)
   !!----------------------------------------------------------------------
CONTAINS

   SUBROUTINE trc_ini_bling( Kmm )
      !!----------------------------------------------------------------------
      !!                     ***  trc_ini_bling  ***  
      !!
      !! ** Purpose :   initialization for BLINGv0 model
      !!
      !! ** Method  : - Read the namcfc namelist and check the parameter values
      !!----------------------------------------------------------------------
      INTEGER, INTENT(in)  ::  Kmm      ! time level indices

      !                       ! Allocate BLINGv0 arrays

      CALL trc_nam_bling 

      IF(lwp) WRITE(numout,*)
      IF(lwp) WRITE(numout,*) ' trc_ini_bling: initialisation of BLINGv0 model'
      IF(lwp) WRITE(numout,*) ' ~~~~~~~~~~~~~~'

      ! Allocate BLINGv0 arrays
      IF( bling_alloc() /= 0 )   CALL ctl_stop( 'STOP', 'trc_ini_bling: unable to allocate BLINGv0 arrays' )                   

      ! Set time step
      rfact = rn_Dt

      IF( .NOT. ln_rsttr ) THEN
        ! initialize prognostic tracers
        tr(:,:,:,jpPO4_bling,Kmm) = 2.174e-6_wp * tmask(:,:,:) 
        tr(:,:,:,jpDOP_bling,Kmm) = 1.000e-8_wp * tmask(:,:,:) 
        tr(:,:,:,jpFed_bling,Kmm) = 0.6E-9      * tmask(:,:,:) 
        tr(:,:,:,jpOxy_bling,Kmm) = 177.6e-6_wp * tmask(:,:,:) 
        tr(:,:,:,jpDIC_bling,Kmm) = 0.0_wp      * tmask(:,:,:)
        tr(:,:,:,jpalk_bling,Kmm) = 0.0_wp      * tmask(:,:,:)
        !!! --- AGT: Add nitrogen tracers --- !!!
        IF ( ln_nitro ) THEN
                tr(:,:,:,jpNO3_bling,Kmm) = 1.000e-4_wp * tmask(:,:,:)
                tr(:,:,:,jpDON_bling,Kmm) = 1.000e-6_wp * tmask(:,:,:)
        ENDIF
        !!! ------ !!!
      ENDIF
         
      ! initialize diagnostic tracers
      fpop_b   (:,:)   = 0.d0
      IF ( ln_nitro ) THEN
              fpon_b (:,:) = 0.d0
      ENDIF
      fpofe_b  (:,:)   = 0.d0
      fcaco3_b (:,:)   = 0.d0
      co2_csurf(:,:)   = 0.d0
      co2_alpha(:,:)   = 0.d0
      chl_bling(:,:,:) = 0.d0
      irr_mem  (:,:,:) = 0.d0
      co3_ion  (:,:,:) = 0.d0
      htotal   (:,:,:) = 1.0e-8

      ! initialize cumulative sums
      sumtffed = 0.d0
      sumtfoxy = 0.d0
      sumbfpo4 = 0.d0
      sumbffed = 0.d0
      sumbfoxy = 0.d0

      CALL trc_opt_bling_init
      CALL trc_ext_init_bling
      CALL trc_sms_init_bling

      ! Data from Mauna Loa station (ftp://aftp.cmdl.noaa.gov/products/trends/co2/co2_annmean_mlo.txt) 1959-2018
    !  pco2= (/ 315.97,316.91,317.64,318.45,318.99,319.62,320.04,321.38,322.16,323.04 &
    !          ,324.62,325.68,326.32,327.45,329.68,330.18,331.08,332.05,333.78,335.41 &
    !          ,336.78,338.68,340.10,341.44,343.03,344.58,346.04,347.39,349.16,351.56 &
    !          ,353.07,354.35,355.57,356.38,357.07,358.82,360.80,362.59,363.71,366.65 &
    !          ,368.33,369.52,371.13,373.22,375.77,377.49,379.80,381.90,383.76,385.59 &
    !          ,387.37,389.85,391.63,393.82,396.48,398.61,400.83,404.29,406.53,406.53 /)
      !INTEGER :: nypco2=(/ 1959 1960 1961 1962 1963 1964 1965 1966 1967 1968 &
      !                    ,1969 1970 1971 1972 1973 1974 1975 1976 1977 1978 &
      !                    ,1979 1980 1981 1982 1983 1984 1985 1986 1987 1988 &
      !                    ,1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 &
      !                    ,1999 2000 2001 2002 2003 2004 2005 2006 2007 2008 &
      !                    ,2009 2010 2011 2012 2013 2014 2015 2016 2017 2018 /)

! HYPE simulation Historical (MaunaLoa 1959-2005) - rcp45(CSMI-BGC 2006-2100)
    ! Data from Mauna Loa station (ftp://aftp.cmdl.noaa.gov/products/trends/co2/co2_annmean_mlo.txt) 1959-2018
          pco2= (/ 315.97,316.91,317.64,318.45,318.99,319.62,320.04,321.38,322.16,323.04 &
                  ,324.62,325.68,326.32,327.45,329.68,330.18,331.08,332.05,333.78,335.41 &
                  ,336.78,338.68,340.10,341.44,343.03,344.58,346.04,347.39,349.16,351.56 &
                  ,353.07,354.35,355.57,356.38,357.07,358.82,360.80,362.59,363.71,366.65 &
                  ,368.33,369.52,371.13,373.22,375.77,377.49,379.80 &
                  ,382.86,384.99,386.95,389.08,391.05,393.06,395.20,397.45,399.72,402.35 &
                  ,404.45,406.56,408.72,411.40,413.01,415.45,417.96,419.80,422.71,425.06 &
                  ,427.48,430.19,432.58,435.25,438.02,439.86,442.33,445.15,447.61,449.81 &
                  ,452.86,455.02,458.20,461.07,463.06,466.04,468.38,470.82,473.96,476.36 & 
                  ,478.78,481.78,484.22,486.93,488.74,491.41,494.43,496.18,498.23,500.48 &
                  ,502.69,505.11,507.56,509.60,511.08,513.11,515.21,516.54,518.52,520.26 &
                  ,521.02,522.60,524.42,525.71,526.29,527.23,528.56,529.44,529.74,531.26 &
                  ,531.12,532.16,532.17,532.09,532.92,533.15,533.36,533.21,533.68,533.86 &
                  ,533.85,534.95,535.09,535.35,535.10,535.76,536.42,536.98,537.10,537.59 &
                  ,537.88,538.63,539.20,539.76,540.30 /)
    !INTEGER :: nypco2=(/ 1959 1960 1961 1962 1963 1964 1965 1966 1967 1968 &
    !                    ,1969 1970 1971 1972 1973 1974 1975 1976 1977 1978 &
    !                    ,1979 1980 1981 1982 1983 1984 1985 1986 1987 1988 &
    !                    ,1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 &
    !                    ,1999 2000 2001 2002 2003 2004 2005                &
    !                    ,2006 2007 2008 2009 2010 2011 2012 2013 2014 2015 &
    !                    ,2016 2017 2018 2019 2020 2021 2022 2023 2024 2025 &
    !                    ,2026 2027 2028 2029 2030 2031 2032 2033 2034 2035 &
    !                    ,2036 2037 2038 2039 2040 2041 2042 2043 2044 2045 &
    !                    ,2046 2047 2048 2049 2050 2051 2052 2053 2054 2055 &
    !                    ,2056 2057 2058 2059 2060 2061 2062 2063 2064 2065 &
    !                    ,2066 2067 2068 2069 2070 2071 2072 2073 2074 2075 &
    !                    ,2076 2077 2078 2079 2080 2081 2082 2083 2084 2085 &
    !                    ,2086 2087 2088 2089 2090 2091 2092 2093 2094 2095 &
    !                    ,2096 2097 2098 2099 2011/)



! spin up simulation inter-annual with pre-industrial pco2 (LC 2018) use the same length of vector as defined in vars_blingv0
     ! pco2= (/ 280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00 &
     !         ,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00 &
     !         ,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00 &
     !         ,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00 &
     !         ,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00 &
     !         ,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00,280.00  /)

   END SUBROUTINE trc_ini_bling

   !!======================================================================
END MODULE trcini_bling
